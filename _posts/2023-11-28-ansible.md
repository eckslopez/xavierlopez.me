---
layout: post
title:  "Ansible"
date:   2023-11-28 09:52:00 +0000
categories: ansible
---
- Concepts:
  - Modules: Discrete units of code that can be used from the command line or in a playbook task. Ansible executes each module, usually on the remote managed node, and collects return values. In Ansible 2.10 and later, most modules are hosted in collections. Modules support taking arguments.
  - Collections: A distributed format for content that can include playbooks, roles, modules, and plugins. You can install and use collections through a distribution server, such as Ansible Galaxy.
  - Plugins: Pieces of code that augment Ansible's core functionality. Ansible uses a plugin architecture to enable a rich, flexible and expandable feature set. Ansible ships with some plugins. You can write your own.
    - Example: Action plugins act in conjunction with modules to the execute actions required by playbook tasks. 
  - Facts: Variables related to remote systems.
  - Magic Variables: variables related to Ansible itself.
- Gather facts from one host:
`ansible <host-name-or-IP> -m ansible.builtin.setup`
- Run an ad-hoc command:
`ansible sherman -m command -a "getent hosts"`
- All strategy plugins are enabled by default. Strategies for controlling playbook execution:
  - To see the list of available strategy plugins: `ansible-doc -t strategy -l`
  - Set in ansible.cfg
{% highlight ruby %}          
[defaults]
strategy=linear
{% endhighlight %}
  - linear - runs each task on all hosts before moving on.
  - free - all hosts run through tasks as quickly as possible, without waiting for one another.
  - forking - number of workers running simultaneously, for parallelism.
  - host_pinned - uninterrupted execution per host.
  - debug - prints statements during execution and can be useful for debugging variabled and expressions without necessarily halting the playbook.
  - serial - allow x number of hosts to run in batches. especially useful in rolling update scenarios.
  - throttling - limit the number of simultaneous workers. 
